<!DOCTYPE html>
<html lang="pt-BR" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <title>Log√≠stica MBLOG ‚Ä¢ Painel NF-e</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Fonte -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Favicon MBLOG -->
    <link rel="icon" type="image/svg+xml"
          href="data:image/svg+xml,%3Csvg width='64' height='64' viewBox='0 0 64 64' xmlns='http://www.w3.org/2000/svg'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0' y1='0' x2='1' y2='1'%3E%3Cstop offset='0%25' stop-color='%230ea5e9'/%3E%3Cstop offset='50%25' stop-color='%233b82f6'/%3E%3Cstop offset='100%25' stop-color='%23ef4444'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect rx='18' ry='18' width='64' height='64' fill='url(%23g)'/%3E%3Ctext x='32' y='38' text-anchor='middle' font-family='system-ui' font-size='22' font-weight='700' fill='%23000'%3EMB%3C/text%3E%3C/svg%3E" />

    <!-- XLSX + JSZip -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>

    <!-- Script principal -->
    <script src="script.js" defer></script>

    <style>
        :root {
            --bg-body: radial-gradient(circle at top, #1e293b 0, #020617 55%, #000 100%);
            --bg-card: rgba(15, 23, 42, 0.96);
            --bg-card-soft: rgba(15, 23, 42, 0.9);
            --accent: #0ea5e9;
            --accent-2: #22c55e;
            --accent-3: #a855f7;
            --danger: #ef4444;
            --text-main: #e5e7eb;
            --text-muted: #94a3b8;
            --border-subtle: rgba(148, 163, 184, 0.35);
            --shadow-soft: 0 25px 60px rgba(15, 23, 42, 0.9);
        }

        html[data-theme="light"] {
            --bg-body: radial-gradient(circle at top, #e0f2fe 0, #f3f4f6 55%, #e5e7eb 100%);
            --bg-card: #f9fafb;
            --bg-card-soft: #ffffff;
            --text-main: #020617;
            --text-muted: #6b7280;
            --shadow-soft: 0 18px 40px rgba(15, 23, 42, 0.12);
        }

        * { box-sizing: border-box; }

        body {
            margin: 0;
            min-height: 100vh;
            font-family: "Poppins", system-ui, -apple-system, "Segoe UI", sans-serif;
            background: var(--bg-body);
            color: var(--text-main);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 24px;
        }

        .shell {
            width: 100%;
            max-width: 1120px;
        }

        /* TOP BAR */

        .top-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            margin-bottom: 20px;
        }

        .brand-row {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .brand-icon {
            width: 46px;
            height: 46px;
            border-radius: 999px;
            background:
                radial-gradient(circle at 20% 0, #e5e7eb 0, transparent 35%),
                conic-gradient(from 220deg, #0ea5e9, #22c55e, #a855f7, #0ea5e9);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            box-shadow:
                    0 12px 35px rgba(15, 23, 42, 0.9),
                    0 0 0 1px rgba(148, 163, 184, 0.35);
        }

        .brand-icon span {
            font-weight: 700;
            font-size: 17px;
            color: #020617;
        }

        .brand-text { display: flex; flex-direction: column; gap: 2px; }

        .brand-title { font-size: 19px; font-weight: 600; letter-spacing: 0.06em; }
        .by-author { font-size: 12px; color: var(--text-muted); }

        .nav-tabs {
            display: inline-flex;
            gap: 4px;
            padding: 4px;
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.85);
            border: 1px solid rgba(148, 163, 184, 0.45);
        }

        .nav-tab {
            border-radius: 999px;
            padding: 4px 12px;
            border: none;
            background: transparent;
            color: var(--text-muted);
            font-size: 11px;
            cursor: pointer;
        }

        .nav-tab.active {
            background: radial-gradient(circle at top, rgba(14,165,233,0.17), rgba(34,197,94,0.17));
            color: var(--accent-2);
            font-weight: 600;
        }

        .top-right {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mode-indicator {
            font-size: 11px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 9px;
            border-radius: 999px;
            border: 1px solid rgba(148,163,184,0.4);
            background: rgba(15,23,42,0.9);
        }

        .mode-dot {
            width: 8px;
            height: 8px;
            border-radius: 999px;
            background: #22c55e;
            box-shadow: 0 0 8px rgba(34,197,94,0.9);
        }

        .theme-toggle {
            border-radius: 999px;
            padding: 5px 11px;
            border: 1px solid rgba(148,163,184,0.45);
            background: rgba(15,23,42,0.9);
            color: var(--text-main);
            font-size: 11px;
            cursor: pointer;
        }

        /* MAIN CARD */

        .card-main {
            background: radial-gradient(circle at top left,
            rgba(15, 23, 42, 0.98),
            rgba(15, 23, 42, 0.96));
            border-radius: 24px;
            padding: 22px 22px 24px;
            border: 1px solid rgba(148, 163, 184, 0.28);
            box-shadow: var(--shadow-soft);
        }

        html[data-theme="light"] .card-main {
            background: #f9fafb;
        }

        .card-main h1 {
            margin: 0;
            font-size: 21px;
        }

        .subtitle {
            margin-top: 4px;
            margin-bottom: 18px;
            font-size: 13px;
            color: var(--text-muted);
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        /* PROCESSOR LAYOUT */

        .grid {
            display: grid;
            grid-template-columns: 1.2fr 1fr;
            gap: 18px;
        }

        @media (max-width: 880px) {
            .grid { grid-template-columns: 1fr; }
            .top-bar { flex-direction: column; align-items: flex-start; }
        }

        .card {
            background: var(--bg-card);
            border-radius: 18px;
            padding: 16px;
            border: 1px solid rgba(148,163,184,0.35);
        }

        html[data-theme="light"] .card {
            background: #ffffff;
        }

        .card-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .hint {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 10px;
        }

        input[type="file"] {
            width: 100%;
            font-size: 12px;
            color: var(--text-muted);
        }

        input[type="file"]::file-selector-button {
            padding: 6px 12px;
            border-radius: 999px;
            border: none;
            background: linear-gradient(120deg, #0ea5e9, #22c55e, #a855f7);
            color: #020617;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            margin-right: 8px;
        }

        .btn-primary {
            margin-top: 12px;
            padding: 9px 14px;
            width: 100%;
            border-radius: 999px;
            border: none;
            background: radial-gradient(circle at top left, #0ea5e9, #22c55e);
            color: #020617;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            box-shadow:
                    0 14px 30px rgba(56,189,248,0.25),
                    0 0 0 1px rgba(15,23,42,0.9);
        }

        /* LOG TERMINAL */

        .log-box {
            border-radius: 14px;
            padding: 10px 12px;
            background: radial-gradient(circle at top left, #020617, #020617 60%, #020617);
            border: 1px solid rgba(34,197,94,0.4);
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            font-size: 11px;
            height: 170px;
            overflow-y: auto;
            color: #4ade80;
            box-shadow: 0 0 20px rgba(34,197,94,0.25) inset;
        }

        .log-box::before {
            content: "‚ñ∂ MBLOG/terminal";
            display: block;
            font-size: 10px;
            color: #a5b4fc;
            margin-bottom: 4px;
        }

        /* DRIVE CTA */

        .drive-cta {
            margin-top: 26px;
            padding: 2px;
            border-radius: 18px;
            background: linear-gradient(120deg,#0ea5e9,#22c55e,#a855f7,#ef4444);
            box-shadow:
                    0 20px 50px rgba(15,23,42,0.8),
                    0 0 0 1px rgba(15,23,42,0.9);
        }

        .drive-cta-inner {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 18px;
            padding: 16px 18px;
            border-radius: 16px;
            background: linear-gradient(135deg,#020617,#020617 40%,#020617);
        }

        .drive-cta-title {
            font-size: 15px;
            font-weight: 600;
        }

        .drive-cta-subtitle {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .drive-cta-button {
            border: none;
            border-radius: 999px;
            padding: 9px 18px;
            background: rgba(15,23,42,0.95);
            color: #ecfeff;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow:
                    0 14px 35px rgba(34,197,94,0.45),
                    0 0 0 1px rgba(15,23,42,1);
        }

        .drive-cta-icon {
            width: 18px;
            height: 18px;
            border-radius: 999px;
            background: radial-gradient(circle at 30% 0,#e5e7eb,#22c55e);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            color: #020617;
        }

        /* DASHBOARD */

        .dash-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit,minmax(140px,1fr));
            gap: 12px;
            margin-bottom: 16px;
        }

        .dash-card {
            padding: 10px 12px;
            border-radius: 14px;
            background: var(--bg-card-soft);
            border: 1px solid rgba(148,163,184,0.35);
        }

        .dash-label {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--text-muted);
        }

        .dash-value {
            font-size: 18px;
            font-weight: 600;
        }

        .dash-chip {
            font-size: 10px;
            color: var(--text-muted);
            margin-top: 2px;
        }

        .dash-grid {
            display: grid;
            grid-template-columns: 1.1fr 1.1fr;
            gap: 14px;
        }

        @media (max-width: 900px) {
            .dash-grid { grid-template-columns: 1fr; }
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }

        th, td {
            padding: 6px 8px;
            border-bottom: 1px solid rgba(15,23,42,0.7);
        }

        th {
            text-align: left;
            font-weight: 500;
            color: var(--text-muted);
            font-size: 11px;
        }

        .muted {
            color: var(--text-muted);
            font-size: 12px;
        }
    </style>
</head>
<body>
<div class="shell">

    <!-- TOPO -->
    <div class="top-bar">
        <div class="brand-row">
            <div class="brand-icon"><span>MB</span></div>
            <div class="brand-text">
                <div class="brand-title">LOG√çSTICA MBLOG</div>
                <div class="by-author">by Paulo Corr√™a ‚Ä¢ Painel NF-e</div>

                <div class="nav-tabs">
                    <button class="nav-tab active" data-section="processor">Processador NF-e</button>
                    <button class="nav-tab" data-section="dashboard">Dashboard</button>
                    <button class="nav-tab" data-section="tools">Ferramentas extras</button>
                </div>
            </div>
        </div>

        <div class="top-right">
            <div class="mode-indicator">
                <span class="mode-dot"></span>
                <span id="modeLabel">Modo escuro</span>
            </div>
            <button id="themeToggle" class="theme-toggle">Alternar tema</button>
        </div>
    </div>

    <!-- CARD PRINCIPAL -->
    <div class="card-main">
        <h1>Painel NF-e ‚Ä¢ Coletor XML</h1>
        <div class="subtitle">
            Importe seus XML (ou ZIP de XML) e acompanhe os indicadores de notas, volumes, peso, cidades e produtos.
        </div>

        <!-- SE√á√ÉO PROCESSADOR -->
        <section id="section-processor" class="section active">
            <div class="grid">
                <div class="card">
                    <div class="card-title">1. Importar arquivos XML / ZIP</div>
                    <p class="hint">
                        Selecione m√∫ltiplos <b>.xml</b> ou um <b>.zip</b> baixado da pasta <b>Coletor XML</b> no Google Drive.
                        Todo o processamento acontece localmente no seu navegador.
                    </p>
                    <input type="file" id="xmlFiles" accept=".xml,.zip" multiple>
                    <button id="btnProcessar" class="btn-primary">
                        Processar XMLs e gerar XLSX
                    </button>
                    <p class="muted" style="margin-top:8px;">
                        O arquivo <b>Relatorio_NFe.xlsx</b> ser√° salvo automaticamente na pasta de downloads.
                    </p>
                </div>

                <div class="card">
                    <div class="card-title">2. Log de processamento</div>
                    <div id="log" class="log-box">
                        Aguardando processamento...
                    </div>
                </div>
            </div>

            <!-- CTA Drive -->
            <div class="drive-cta">
                <div class="drive-cta-inner">
                    <div>
                        <div class="drive-cta-title">Fluxo com Google Drive ‚Ä¢ Pasta "Coletor XML"</div>
                        <div class="drive-cta-subtitle">
                            1) Seus XML chegam por e-mail e s√£o enviados para a pasta <b>Coletor XML</b>.<br>
                            2) Clique no bot√£o ao lado para abrir a pasta direto no Drive.<br>
                            3) Selecione os arquivos desejados e use <b>Fazer download</b> (o Drive gera um ZIP).<br>
                            4) Volte aqui, selecione o ZIP no campo acima e gere seu relat√≥rio.
                        </div>
                    </div>
                    <button id="btnDrive" class="drive-cta-button">
                        <span class="drive-cta-icon">‚òÅ</span>
                        <span>Abrir pasta no Drive</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- SE√á√ÉO DASHBOARD -->
        <section id="section-dashboard" class="section">
            <div class="card" style="margin-bottom:14px;">
                <div class="card-title">Resumo geral</div>
                <p class="muted" id="dashInfo">Importe arquivos na aba Processador para atualizar os dados abaixo.</p>

                <div class="dash-cards">
                    <div class="dash-card">
                        <div class="dash-label">Notas fiscais</div>
                        <div class="dash-value" id="dashNotas">0</div>
                        <div class="dash-chip">Quantidade total de NF-e processadas</div>
                    </div>
                    <div class="dash-card">
                        <div class="dash-label">Volumes totais</div>
                        <div class="dash-value" id="dashVolumes">0</div>
                        <div class="dash-chip">Somat√≥rio do campo qVol</div>
                    </div>
                    <div class="dash-card">
                        <div class="dash-label">Peso total (kg)</div>
                        <div class="dash-value" id="dashPeso">0</div>
                        <div class="dash-chip">Somat√≥rio do campo pesoB</div>
                    </div>
                    <div class="dash-card">
                        <div class="dash-label">Clientes √∫nicos</div>
                        <div class="dash-value" id="dashClientes">0</div>
                        <div class="dash-chip">Quantidade de destinat√°rios distintos</div>
                    </div>
                    <div class="dash-card">
                        <div class="dash-label">Cidades atendidas</div>
                        <div class="dash-value" id="dashCidades">0</div>
                        <div class="dash-chip">Total de munic√≠pios presentes nas notas</div>
                    </div>
                    <div class="dash-card">
                        <div class="dash-label">Produtos distintos</div>
                        <div class="dash-value" id="dashProdutos">0</div>
                        <div class="dash-chip">Itens √∫nicos no resumo de produtos</div>
                    </div>
                </div>

                <div class="dash-grid">
                    <div>
                        <div class="card-title" style="font-size:13px;margin-bottom:4px;">Top cidades por volume</div>
                        <table id="tblCidades">
                            <thead>
                            <tr>
                                <th>Cidade</th>
                                <th>Notas</th>
                                <th>Volumes</th>
                            </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <div>
                        <div class="card-title" style="font-size:13px;margin-bottom:4px;">Top produtos por quantidade</div>
                        <table id="tblProdutos">
                            <thead>
                            <tr>
                                <th>Produto</th>
                                <th>Un.</th>
                                <th>Qtd.</th>
                            </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- SE√á√ÉO FERRAMENTAS -->
        <section id="section-tools" class="section">
            <div class="card">
                <div class="card-title">Ferramentas extras ‚Ä¢ Em desenvolvimento</div>
                <p class="muted">
                    Aqui v√£o entrar recursos como:<br>
                    ‚Ä¢ Validador r√°pido de XML<br>
                    ‚Ä¢ Consulta de CNPJ<br>
                    ‚Ä¢ Painel de SLA e performance<br>
                    ‚Ä¢ Exporta√ß√£o customizada para outros formatos<br><br>
                    Mas o cora√ß√£o do sistema (Processador + Dashboard) j√° est√° pronto para rodar na opera√ß√£o da MBLOG. üòâ
                </p>
            </div>
        </section>
    </div>
</div>
</body>
</html>
